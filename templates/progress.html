<!DOCTYPE html>
<html>
<head>
    <title>Mood Progress</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <h2>Mood Distribution</h2>
    <h3 id="moodSummary"></h3>
    <p id="moodMessage" style="font-style: italic;"></p> <!-- ðŸ’¡ Motivational message -->

    <canvas id="moodBarChart" width="600" height="400"></canvas>

    <script>
        const username = localStorage.getItem("username") || "guest";

        fetch(`/get_mood_data?username=${username}`)
            .then(response => response.json())
            .then(result => {
                const data = result.moods;
                const summary = result.summary;

                const maxMood = Object.keys(summary).reduce((a, b) => summary[a] > summary[b] ? a : b);

                // ðŸŒŸ Summary Text
                const moodMessages = {
                    positive: "You've been feeling mostly positive this week ðŸ˜Š",
                    neutral: "Youâ€™ve been mostly neutral â€“ maybe itâ€™s been a calm week ðŸ˜Œ",
                    negative: "Looks like you've been going through a tough week ðŸ˜”"
                };
                document.getElementById("moodSummary").textContent = moodMessages[maxMood];

                // ðŸ’¬ Motivational / supportive messages
                const motivationalMessages = {
                    positive: "Keep spreading the good vibes! ðŸŒˆ You're doing amazing.",
                    neutral: "Balance is beautiful. Keep going one step at a time ðŸŒ¿",
                    negative: "Hang in there ðŸ’ª You're stronger than you think. Brighter days are ahead!"
                };
                document.getElementById("moodMessage").textContent = motivationalMessages[maxMood];

                // ðŸ“Š Bar Chart
                const ctxBar = document.getElementById('moodBarChart').getContext('2d');
                new Chart(ctxBar, {
                    type: 'bar',
                    data: {
                        labels: ['Positive', 'Neutral', 'Negative'],
                        datasets: [{
                            label: 'Mood Frequency',
                            data: [summary.positive, summary.neutral, summary.negative],
                            backgroundColor: ['#4CAF50', '#FFC107', '#F44336']
                        }]
                    },
                    options: {
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Number of Entries'
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            }
                        }
                    }
                });
            });
    </script>
</body>
</html>
